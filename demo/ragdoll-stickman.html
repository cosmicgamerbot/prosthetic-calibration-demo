<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>Ragdoll Stickman Demo (Matter.js)</title>
  <style>
    body { background: #f5f5f5; margin: 0; }
    canvas { display: block; margin: 0 auto; }
    #desc { text-align: center; margin: 12px; font-family: sans-serif;}
  </style>
</head>
<body>
<div id="desc">
  <b>Ragdoll Stickman Demo &bull; Drag to interact (Unity-like)</b>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
<script>
const { Engine, Render, World, Bodies, Constraint, Mouse, MouseConstraint } = Matter;

const width = 600, height = 500;

const engine = Engine.create();
const render = Render.create({
  element: document.body,
  engine: engine,
  options: {
    width, height,
    wireframes: false,
    background: "#fff"
  }
});

// Ragdoll segments (bodies with positions and sizing)
const head = Bodies.circle(300, 100, 22, {restitution: 0.2, density: 0.001, render: {fillStyle: '#BBB'}});
const torso = Bodies.rectangle(300, 160, 25, 80, {density: 0.002, render: {fillStyle: '#666'}});
const upperArmR = Bodies.rectangle(275, 142, 55, 13, {density: 0.001, render: {fillStyle: '#444'}});
const upperArmL = Bodies.rectangle(325, 142, 55, 13, {density: 0.001, render: {fillStyle: '#444'}});
const lowerArmR = Bodies.rectangle(245, 142, 45, 12, {density: 0.001, render: {fillStyle: '#888'}});
const lowerArmL = Bodies.rectangle(355, 142, 45, 12, {density: 0.001, render: {fillStyle: '#888'}});
const upperLegR = Bodies.rectangle(290, 225, 15, 55, {density: 0.0015, render: {fillStyle: '#444'}});
const upperLegL = Bodies.rectangle(310, 225, 15, 55, {density: 0.0015, render: {fillStyle: '#444'}});
const lowerLegR = Bodies.rectangle(290, 265, 13, 50, {density: 0.0015, render: {fillStyle: '#888'}});
const lowerLegL = Bodies.rectangle(310, 265, 13, 50, {density: 0.0015, render: {fillStyle: '#888'}});

// Joints (constraints with limits)
const joints = [
// Neck
  Constraint.create({ bodyA: head, pointA: {x:0, y:22},
                      bodyB: torso, pointB: {x:0, y:-40}, stiffness: 0.7 }),
// Shoulders
  Constraint.create({ bodyA: torso, pointA: {x:-11, y:-38},
                      bodyB: upperArmR, pointB: {x:26, y:0}, length:0, stiffness:0.6 }),
  Constraint.create({ bodyA: torso, pointA: {x:11, y:-38},
                      bodyB: upperArmL, pointB: {x:-26, y:0}, length:0, stiffness:0.6 }),
// Elbows
  Constraint.create({ bodyA: upperArmR, pointA: {x:-26, y:0},
                      bodyB: lowerArmR, pointB: {x:22, y:0}, length:0, stiffness:0.5 }),
  Constraint.create({ bodyA: upperArmL, pointA: {x:26, y:0},
                      bodyB: lowerArmL, pointB: {x:-22, y:0}, length:0, stiffness:0.5 }),
// Torso-Hips
  Constraint.create({ bodyA: torso, pointA: {x:-7, y:40},
                      bodyB: upperLegR, pointB: {x:0, y:-27}, stiffness:0.7 }),
  Constraint.create({ bodyA: torso, pointA: {x:7, y:40},
                      bodyB: upperLegL, pointB: {x:0, y:-27}, stiffness:0.7 }),
// Knees
  Constraint.create({ bodyA: upperLegR, pointA: {x:0, y:27},
                      bodyB: lowerLegR, pointB: {x:0, y:-23}, stiffness:0.6 }),
  Constraint.create({ bodyA: upperLegL, pointA: {x:0, y:27},
                      bodyB: lowerLegL, pointB: {x:0, y:-23}, stiffness:0.6 }),
// Feet-to-ground
  Constraint.create({ bodyA: lowerLegR, pointA: {x:0, y:23},
                      pointB: {x:290, y:height-20}, stiffness:0.07, length:10, render:{visible:false} }),
  Constraint.create({ bodyA: lowerLegL, pointA: {x:0, y:23},
                      pointB: {x:310, y:height-20}, stiffness:0.07, length:10, render:{visible:false} })
];

// Add a ground
const ground = Bodies.rectangle(width/2, height-10, width, 20, {isStatic:true, render:{fillStyle:'#333'}});

// Add all to the physics world
World.add(engine.world, [
  head, torso,
  upperArmR, upperArmL, lowerArmR, lowerArmL,
  upperLegR, upperLegL, lowerLegR, lowerLegL,
  ...joints,
  ground
]);

// Enable mouse dragging
World.add(engine.world, MouseConstraint.create(engine, {
  mouse: Mouse.create(render.canvas),
  constraint: { stiffness: 0.25, render: {visible: false } }
}));

Engine.run(engine);
Render.run(render);
</script>
</body>
</html>
