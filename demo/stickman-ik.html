<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Stickman Foot IK Demo</title>
  <style>
    canvas { background: #f5f5f5; display: block; margin: 0 auto; }
    #controls { text-align: center; margin: 20px; }
  </style>
</head>
<body>
  <div id="controls">
    <label>Foot Target X: <input type="range" id="footX" min="200" max="400" value="300"></label>
    <label>Foot Target Y: <input type="range" id="footY" min="300" max="450" value="400"></label>
  </div>
  <canvas width="600" height="500" id="c"></canvas>
  <script>
    // Simple 2-segment leg inverse kinematics (hip-knee-foot)
    const ctx = document.getElementById('c').getContext('2d');
    const hip = {x: 300, y: 150};
    const thighLength = 120;
    const shinLength = 120;

    function drawStickman(footTargetX, footTargetY) {
      ctx.clearRect(0, 0, 600, 500);

      // IK: Calculate knee position given foot target
      let dx = footTargetX - hip.x;
      let dy = footTargetY - hip.y;
      let dist = Math.sqrt(dx*dx + dy*dy);

      // Clamp for reachability
      dist = Math.min(dist, thighLength + shinLength - 1);

      let a = Math.acos((thighLength*thighLength + dist*dist - shinLength*shinLength)/(2*thighLength*dist));
      let legAngle = Math.atan2(dy, dx);
      let thighAngle = legAngle - a;

      // Knee coordinates
      let kneeX = hip.x + thighLength * Math.cos(thighAngle);
      let kneeY = hip.y + thighLength * Math.sin(thighAngle);

      // Draw stickman (body, arms, one animated leg)
      // Head
      ctx.beginPath();
      ctx.arc(hip.x, hip.y-40, 25, 0, 2*Math.PI);
      ctx.stroke();

      // Body
      ctx.beginPath();
      ctx.moveTo(hip.x, hip.y-15);
      ctx.lineTo(hip.x, hip.y+80); // Spine
      ctx.stroke();

      // Arms
      ctx.beginPath();
      ctx.moveTo(hip.x-60, hip.y+20);
      ctx.lineTo(hip.x+60, hip.y+20);
      ctx.stroke();

      // Static left leg
      ctx.beginPath();
      ctx.moveTo(hip.x, hip.y+80);
      ctx.lineTo(hip.x-40, hip.y+170);
      ctx.stroke();

      // Animated right leg
      ctx.beginPath();
      ctx.moveTo(hip.x, hip.y+80);
      ctx.lineTo(kneeX, kneeY);
      ctx.lineTo(footTargetX, footTargetY);
      ctx.stroke();

      // Foot circle
      ctx.beginPath();
      ctx.arc(footTargetX, footTargetY, 10, 0, 2*Math.PI);
      ctx.fillStyle = "#0074D9";
      ctx.fill();
    }

    function update() {
      let x = parseInt(document.getElementById('footX').value);
      let y = parseInt(document.getElementById('footY').value);
      drawStickman(x, y);
    }

    document.getElementById('footX').addEventListener('input', update);
    document.getElementById('footY').addEventListener('input', update);

    update();
  </script>
</body>
</html>
